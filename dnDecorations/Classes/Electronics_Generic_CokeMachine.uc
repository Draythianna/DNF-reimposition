/*******************************************************************************
 * Electronics_Generic_CokeMachine generated by Eliot.UELib using UELib.CLI.
 * Eliot.UELib Â© 2009-2022 Eliot van Uytfanghe. All rights reserved.
 * http://eliotvu.com
 *
 * All rights belong to their respective owners.
 *******************************************************************************/
class Electronics_Generic_CokeMachine extends Electronics_Generic
	collapsecategories;

var SMountedActorPrefab DrinkMountPrefab;
var() noexport bool bDontPhysicsSpawnedItem "Do NOT explicity turn physics on for spawned item";
var() noexport MaterialEx ButtonMaterials[4] "Materials to use on spawned buttons";
var bool bCanVend;
var int DestructionSpawnCount;
var int DestructionSpawnCountVar;
var int MaxCans;
var float DestructionSpawnDelay;
var float DestructionSpawnDelayVar;

final function SpawnItem(MaterialEx CanMaterial)
{
	local KarmaActor A;

	// End:0xA2
	if(bCanVend)
	{
		A = KarmaActor(__NFUN_837__(DrinkMountPrefab));
		// End:0x8A
		if(__NFUN_340__(A, none))
		{
			// End:0x47
			if(__NFUN_340__(CanMaterial, none))
			{
				A.__NFUN_741__(1, CanMaterial);
			}
			FindAndPlaySound('CokeMachine_Vend', 1);
			// End:0x8A
			if(__NFUN_145__(bDontPhysicsSpawnedItem))
			{
				A.__NFUN_642__(18);
				A.__NFUN_812__(1);
				A.__NFUN_817__();
			}
		}
		__NFUN_185__(MaxCans);
		// End:0xA2
		if(__NFUN_171__(MaxCans, 0))
		{
			DisableVend();
		}
	}
	return;
}

final function StartDestructionSpawn()
{
	// End:0x21
	if(bCanVend)
	{
		DestructionSpawnCount = __NFUN_190__(default.DestructionSpawnCount, DestructionSpawnCountVar);
		SpawnDestructionItem();
	}
	return;
}

final function SpawnDestructionItem()
{
	local float Delay;

	Delay = __NFUN_226__(DestructionSpawnDelay, DestructionSpawnDelayVar);
	SpawnItem(ButtonMaterials[__NFUN_187__(4)]);
	__NFUN_185__(DestructionSpawnCount);
	// End:0x42
	if(__NFUN_170__(DestructionSpawnCount, 0))
	{
		__NFUN_607__(Delay, false, 'SpawnDestructionItem');
	}
	return;
}

event Trigger(Actor Other, Pawn EventInstigator)
{
	super(dnDecoration).Trigger(Other, EventInstigator);
	StartDestructionSpawn();
	return;
}

final function DisableVend()
{
	bCanVend = false;
	return;
}

event RegisterPrecacheComponents(PrecacheIndex PrecacheIndex)
{
	local int i;

	super(dnDecoration).RegisterPrecacheComponents(PrecacheIndex);
	PrecacheIndex.__NFUN_1268__(DrinkMountPrefab);
	PrecacheIndex.__NFUN_1277__(VoicePack, 'CokeMachine_Vend');
	i = 0;
	J0x3B:

	// End:0x69 [Loop If]
	if(__NFUN_169__(i, 4))
	{
		PrecacheIndex.__NFUN_1269__(ButtonMaterials[i]);
		__NFUN_184__(i);
		// [Loop Continue]
		goto J0x3B;
	}
	return;
}

defaultproperties
{
	DrinkMountPrefab=(bSkipVerifySelf=false,SpawnClass='Details_Generic_DrinkCan',SpawnChance=0,MountPrefab=(bDontActuallyMount=true,bHideable=false,bIndependentRotation=false,bIndependentLocation=false,bMatchParentLocation=false,bMatchParentRotation=false,bSurviveDismount=false,bDontScaleByDrawScale=false,bScaleByDrawScaleNonDefault=false,bTransformDrawScale3DChange=false,bTakeParentTag=false,bTransferToCorpse=false,bDontSetOwner=false,MountParentTag=None,DrawScaleOverride=0,AppendToTag=None,ForceTag=None,ForceEvent=None,MountMeshItem=None,MountOrigin=(X=1.291717E-41,Y=2.8028E-17,Z=0),Z=-37),MountOriginVariance=(X=1.291717E-41,Y=2.797242E-17,Z=0),Z=0)
	ButtonMaterials[0]='mt_skins7.Beer_40oz.ChubbeCola_bs'
	ButtonMaterials[1]='mt_skins7.Beer_40oz.Frappa_bs'
	ButtonMaterials[2]='mt_skins7.Beer_40oz.KrackKola_bs'
	ButtonMaterials[3]='mt_skins7.Beer_40oz.Tanked_bs'
	bCanVend=true
	DestructionSpawnCount=8
	DestructionSpawnCountVar=3
	MaxCans=10
	DestructionSpawnDelay=0.5
	DestructionSpawnDelayVar=0.25
	StartupActivities=/* Array type was not detected. */
	ObjectProperty=1828907520
}